(self.mfeModules=self.mfeModules||[]).push(["pcmall-productshopvouchers",["React","Redux","ReactRedux","PlatformApi","WithInjectReducer","ReactRouter","FeatureToggles","ReactDom","Account","Platform","NebulaCore"],function(e,r,t,o,c,n,i,u,s,a,p){return(self["mfeStartuppcmall-pcpagevoucherdetail"]||function(){})(556),["pcmall-pcpagevoucherdetail",(self.wpJsonpPcmallPcpagevoucherdetail=self.wpJsonpPcmallPcpagevoucherdetail||[]).push([[556,951],{4292:function(e,r,t){"use strict";t.d(r,{Z:function(){return L}});var o=t(3804),c=t.n(o),n=t(9877),i={productShopVoucher:"np6i06",voucher:"r1qW-I",voucherLeftInfo:"UOW7gw",voucherRightContainer:"_9eeNwJ",btnContainer:"JOWRp2",voucherLeft:"P7Rbnu",logo:"XvDcO4",header:"R0ezFk",expiry:"VucaDJ",specificProduct:"VKPtwt",voucherClaimFieldSolid:"BEmIeO",officialHeader:"qmRMfz",preferredHeader:"xS1e3E",sMartHeader:"_3IeCxN",useLaterBtn:"Pz1C0z",applyBtn:"QLgdQ9"},u=t(4840),s=t.n(u),a=t(4316),p=t(7561),h=t(4742),l=t(429),f=t(6775),d=t(6704),v=t(5529),m=t(5377),g=t(5325),_=t(7691),y=t(119),S=t(6866),I=t(6628),P=t(4738),E={progress:y.Z.INIT},L=(0,P.Z)((0,d.withI18nCollections)([n.L])((function(e){var r=e.voucher,t=e.voucherLocation,o=e.className,n=e.isShopeeMart,u=r.is_shop_official,P=r.shop_id,L=r.promotionid,O=r.voucher_code,C=r.percentage_used,R=(0,f.useHistory)(),V=(0,g.useSelector)((function(e){return(0,v.Au)(e.featureToggles,m.v_0)})),b=(0,S.oW)(),N=function(){var e=(0,_.D)(r,{useVLP:V,enableEncodeUrl:b});(0,I.np)(r)&&(e=(0,I.Xz)(r,e)),e&&R.push(e)},w=(0,g.useSelector)((function(e){return r&&r.voucher_code&&e.voucher.claimProgress[r.voucher_code]||E})),x=r.is_claimed_before||w.progress===y.Z.OK?(0,I.np)(r)?2:1:0,D={location:t,shopid:P,promotion_id:L,status:x,voucher_code:O,usage_progress:C},T=(0,h.Z)("ShopVoucherSmall.ProductPageSellerVoucherBody",D,[x]);return c().createElement(l.ZP,{targetType:"ShopVoucherSmall",targetData:{voucher:r,voucherLocation:t}},c().createElement("div",{ref:T,className:s()(i.productShopVoucher,o)},c().createElement(a.rO,{className:i.voucher,voucher:r,type:p.wK.FLAT_WITH_SHADOW,usePreferredShopColorScheme:!0,isOfficial:u,isShopeeMart:n},c().createElement(a.Tg,{className:i.voucherLeft,sawtoothClassName:i.voucherLeftSawtooth,voucher:r,voucherLocation:t,onClick:N},c().createElement("div",{className:i.voucherLeftInfo},c().createElement(a.PU,{sizeStyle:"small",className:i.header}),c().createElement(a.s_,{isOfs:u,className:i.specificProduct,voucher:r,isShopeeMart:n}),c().createElement(a.EU,{className:i.expiry,voucher:r,upcomingGrayText:!0}))),c().createElement(a.Ec,{className:i.voucherRightContainer},c().createElement(a.ve,{voucher:r,className:i.voucherClaimFieldSolid,containerClassName:i.btnContainer,applyBtnClassName:s()(i.applyBtn,(0,I.np)(r)&&i.useLaterBtn),afterClaim:N,applyText:(0,d.t)("label_voucher_seller_voucher_use"),shouldExpandButtonClickArea:!0})),c().createElement(a.Vp,{onTop:!0}))))})))},5603:function(e,r,t){"use strict";t.d(r,{Z:function(){return D}});var o=t(3804),c=t.n(o),n=t(4840),i=t.n(n),u=t(5325),s=t(6775),a=t(8993),p=t(2728),h=t(2157),l=t(6231);function f(){return f=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},f.apply(this,arguments)}function d(e,r){return d=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},d(e,r)}var v,m,g,_,y,S,I,P,E,L,O,C,R,V,b=t(6704),N=t(9877),w=t(4292),x=t(4738),D=(0,x.Z)((0,b.withI18nCollections)([N.L])((v=function(e){var r=e.vouchers,t=e.isShopeeMart;return r&&0!==r.length?c().createElement("div",{className:i()("product-shop-vouchers",e.className)},c().createElement("div",{className:"product-shop-vouchers__header"},(0,b.t)("label_shop_voucher")),c().createElement("div",{className:"product-shop-vouchers__list",style:{maxHeight:"23.25rem"},tabIndex:-1},!!r&&r.slice(0,50).map((function(e,r){return c().createElement(w.Z,{className:"_4kqG0J",key:"product-detail-page-seller-voucher-"+r,voucher:e,voucherLocation:r,isShopeeMart:t})})))):null},g=(m={selector:function(e){return e.voucher},autoFetch:!1}).selector,y=void 0===(_=m.autoFetch)||_,I=void 0!==(S=m.fetchStatus)&&S,E=void 0!==(P=m.forceRender)&&P,O=void 0!==(L=m.isLite)&&L,R=void 0!==(C=m.needPriorityVoucher)&&C,V=function(e){var r,t;function c(r){var t;return(t=e.call(this,r)||this).universalDataFetch=function(){var e,r,o=t.props,c=o.shopId,n=o.itemId,i=o.requestCallback,u=o.isRequesting,s=o.vouchers,a=o.priorityVoucherList;if(c){var p=t.getPriorityVoucherParams(),h=p?[{promotionid:p.priorityPromotionId,signature:p.prioritySignature,signature_source:p.prioritySignatureSource}]:void 0,l=!!s,f=(r=a,!(!(e=h)&&!r||Array.isArray(e)&&Array.isArray(r)&&e[0]&&r[0]&&e[0].promotionid===r[0].promotionid&&e[0].signature===r[0].signature&&e[0].signature_source===r[0].signature_source));if((n||!l||f)&&!u&&y)return O?t.props.fetchShopVouchersLite({shopId:c,withClaimingStatus:I,priorityVoucherList:h,requestCallback:i}):t.props.fetchShopVouchers({shopId:c,itemId:n,withClaimingStatus:I,priorityVoucherList:h,requestCallback:i})}},t}t=e,(r=c).prototype=Object.create(t.prototype),r.prototype.constructor=r,d(r,t);var n=c.prototype;return n.componentDidMount=function(){!this.props.isRequesting&&y&&this.universalDataFetch()},n.componentDidUpdate=function(e){e.shopId===this.props.shopId&&e.itemId===this.props.itemId||this.universalDataFetch()},n.getPriorityVoucherParams=function(){if(R){var e=this.props,r=e.location,t=e.shopId,o=(0,l.AW)(r.search);return o.priorityPromotionId&&o.prioritySignature&&o.prioritySignatureSource?{priorityPromotionId:parseInt(o.priorityPromotionId,10),prioritySignature:o.prioritySignature,prioritySignatureSource:o.prioritySignatureSource}:function(e){return(h.y.getItem("SHOP_PRIORITY_VOUCHER_STORAGE")||{})[e]}(t)}},n.render=function(){var e=this.props.vouchers;return!y||e&&e.length||E?o.createElement(v,f({loadVouchers:this.universalDataFetch},this.props)):null},c}(o.Component),(0,u.connect)((function(e,r){return{vouchers:(0,a.oL)(g(e),r.shopId,r.itemId),priorityVoucherList:(0,a.zM)(g(e),r.shopId),isRequesting:(0,a.Sz)(g(e),r.shopId,r.itemId)}}),{fetchShopVouchers:p.Rd,fetchShopVouchersLite:p._8})((0,s.withRouter)(V)))))},8993:function(e,r,t){"use strict";function o(){return o=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},o.apply(this,arguments)}function c(e,r,t){var o=e&&e.shop&&e.shop[r];if(t){var c=o&&o[t];return c?c.vouchers:null}return o?o.vouchers:null}function n(e,r){var t=e&&e.shop&&e.shop[r];return t?t.priorityVoucherList:null}function i(e,r){return e&&e.recommendedShopVouchers&&e.recommendedShopVouchers[r]||[]}function u(e){return Object.entries(e.claimProgress||[]).reduce((function(e,r){var t,c=r[0],n=r[1];return o({},e,((t={})[c]=n.progress,t))}),{})}function s(e,r){if(!r)return 0;var t=e.claimProgress[r];return t?t.progress:0}function a(e,r,t){var o=e&&e.shop&&e.shop[r];return t?-100===(o&&o[t]||{}).error:o&&-100===o.error}function p(e,r,t){if(!t)return{};var o=e&&e.voucherDetail&&e.voucherDetail[r||"0"];return o&&o[t]||{}}t.d(r,{oL:function(){return c},zM:function(){return n},zq:function(){return i},HL:function(){return u},KT:function(){return s},Sz:function(){return a},hy:function(){return p}})},6686:function(e){"use strict";e.exports=s},1437:function(e){"use strict";e.exports=i},6161:function(e){"use strict";e.exports=a},6704:function(e){"use strict";e.exports=o},3804:function(r){"use strict";r.exports=e},7274:function(e){"use strict";e.exports=u},5325:function(e){"use strict";e.exports=t},6775:function(e){"use strict";e.exports=n},4857:function(e){"use strict";e.exports=r}},0,[[5603,666,132,922]]]),"Z",null]},1]),function(){if(window&&window.__DECKER_HOOK__){var e=window.__DECKER_HOOK__;function r(){e.sendToDevtools("MFE_LOAD_SLOT",{slotName:"pcmall-productshopvouchers",tag:"pc-v5.8.0",branch:"heads/pc-v5.8.0",lastCommit:"chore(release): pc-v5.8.0",lastCommitHash:"b5e71fcabc3665f1ec35c207714416052b7c7b33",updated:"2022-05-26T04:36:32.665Z"})}e.on("MFE_RETRIEVE_SLOTS",r),r()}}();